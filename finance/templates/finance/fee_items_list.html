{% extends 'base.html' %}
{% load humanize %}

{% block content %}
<h2>{{ fee_structure.student_class.name }} - Fee Items</h2>

<!-- Form to add new Fee Item -->
<div class="card mb-4">
    <div class="card-header">
        Add New Fee Item
    </div>
    <div class="card-body">
        <form method="post">
            {% csrf_token %}
            <div class="mb-3">
                {{ form.name.label_tag }}
                {{ form.name }}
                {% if form.name.errors %}
                    <div class="text-danger">{{ form.name.errors }}</div>
                {% endif %}
            </div>
            <div class="mb-3">
                {{ form.amount.label_tag }}
                {{ form.amount }}
                {% if form.amount.errors %}
                    <div class="text-danger">{{ form.amount.errors }}</div>
                {% endif %}
            </div>
            <button type="submit" class="btn btn-success">Add Fee Item</button>
        </form>
    </div>
</div>

<!-- List of existing Fee Items -->
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Fee Name</th>
            <th>Amount</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for item in fee_items %}
        <tr>
            <td>{{ item.name }}</td>
            <td>KES {{ item.amount|intcomma }}</td>
            <td>
                <!-- Edit Fee Item -->
                <a href="{% url 'finance:fee_item_edit' structure_id=fee_structure.id item_id=item.id %}" class="btn btn-warning btn-sm">Edit</a>

                <!-- Delete Fee Item -->
                <form method="post" action="{% url 'finance:fee_item_delete' structure_id=fee_structure.id item_id=item.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this fee item?');">
                        Delete
                    </button>
                </form>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="3">No fee items found</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
